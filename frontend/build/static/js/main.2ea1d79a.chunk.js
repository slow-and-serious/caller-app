(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{109:function(e,t,a){e.exports=a(139)},117:function(e,t,a){e.exports=a.p+"static/media/factory.bddf2578.jpg"},138:function(e,t,a){},139:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),i=a.n(o),c=a(13),l=a(23),s=a(11),m=a(169),u=a(170),p=a(18),f=a(93),g=a(62),d=a(63),h=a(61),b=Object(f.a)({palette:{primary:{light:"#69696a",main:"#28282a",dark:"#1e1e1f"},secondary:{light:"#fff5f8",main:"#ff3366",dark:"#e62958"},warning:{main:"#ffc071",dark:"#ffb25e"},error:{xLight:g.a[50],main:g.a[500],dark:g.a[700]},success:{xLight:d.a[50],main:d.a[500],dark:d.a[700]}},typography:{fontFamily:"'Work Sans', sans-serif",fontSize:14,fontWeightLight:300,fontWeightRegular:400,fontWeightMedium:700,fontFamilySecondary:"'Roboto Condensed', sans-serif"}}),E={color:b.palette.text.primary,fontWeight:b.typography.fontWeightMedium,fontFamily:b.typography.fontFamilySecondary,textTransform:"uppercase"},y=Object(p.a)({},b,{palette:Object(p.a)({},b.palette,{background:Object(p.a)({},b.palette.background,{default:b.palette.common.white,placeholder:h.a[200]})}),typography:Object(p.a)({},b.typography,{fontHeader:E,h1:Object(p.a)({},b.typography.h1,{},E,{letterSpacing:0,fontSize:60}),h2:Object(p.a)({},b.typography.h2,{},E,{fontSize:48}),h3:Object(p.a)({},b.typography.h3,{},E,{fontSize:42}),h4:Object(p.a)({},b.typography.h4,{},E,{fontSize:36}),h5:Object(p.a)({},b.typography.h5,{fontSize:20,fontWeight:b.typography.fontWeightLight}),h6:Object(p.a)({},b.typography.h6,{},E,{fontSize:18}),subtitle1:Object(p.a)({},b.typography.subtitle1,{fontSize:18}),body1:Object(p.a)({},b.typography.body2,{fontWeight:b.typography.fontWeightRegular,fontSize:16}),body2:Object(p.a)({},b.typography.body1,{fontSize:14})})});var v=a(41),x=a(3),j=a(4),w=a(173);var O=Object(j.a)((function(e){return{root:Object(v.a)({color:e.palette.common.white,position:"relative",display:"flex",alignItems:"center"},e.breakpoints.up("sm"),{height:"80vh",minHeight:500,maxHeight:1300}),container:{marginTop:e.spacing(3),marginBottom:e.spacing(14),display:"flex",flexDirection:"column",alignItems:"center"},backdrop:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:e.palette.common.black,opacity:.5,zIndex:-1},background:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundSize:"cover",backgroundRepeat:"no-repeat",zIndex:-2},arrowDown:{position:"absolute",bottom:e.spacing(4)}}}))((function(e){var t=e.backgroundClassName,n=e.children,o=e.classes;return r.a.createElement("section",{className:o.root},r.a.createElement(w.a,{className:o.container},r.a.createElement("img",{src:a(117),alt:"hello",width:"650px",height:"650px"}),n,r.a.createElement("div",{className:o.backdrop}),r.a.createElement("div",{className:Object(x.a)(o.background,t)}),r.a.createElement("img",{className:o.arrowDown,src:"/static/themes/onepirate/productHeroArrowDown.png",height:"16",width:"12",alt:"arrow down"})))}));var k,S=(k=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(O,null))},function(e){return r.a.createElement(m.a,{theme:y},r.a.createElement(u.a,null),r.a.createElement(k,e))}),N=a(51),_=a(175),I=a(176),T=a(191),W=a(174),D=Object(W.a)((function(e){return{"@global":{ul:{margin:0,padding:0,listStyle:"none"}},footer:Object(v.a)({borderTop:"1px solid ".concat(e.palette.divider),marginTop:e.spacing(8),paddingTop:e.spacing(3),paddingBottom:e.spacing(3)},e.breakpoints.up("sm"),{paddingTop:e.spacing(6),paddingBottom:e.spacing(6)})}}));function L(){return r.a.createElement(N.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(_.a,{color:"inherit",href:"https://material-ui.com/"},"Your Website")," ",(new Date).getFullYear(),".")}var F=[{title:"Company",description:["Team","History","Contact us","Locations"]},{title:"Features",description:["Cool stuff","Random feature","Team feature","Developer stuff","Another one"]},{title:"Resources",description:["Resource","Resource name","Another resource","Final resource"]},{title:"Legal",description:["Privacy policy","Terms of use"]}];var R=function(){var e=D();return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{maxWidth:"md",component:"footer",className:e.footer},r.a.createElement(I.a,{container:!0,spacing:4,justify:"space-evenly"},F.map((function(e){return r.a.createElement(I.a,{item:!0,xs:6,sm:3,key:e.title},r.a.createElement(N.a,{variant:"h6",color:"textPrimary",gutterBottom:!0},e.title),r.a.createElement("ul",null,e.description.map((function(e){return r.a.createElement("li",{key:e},r.a.createElement(_.a,{href:"#",variant:"subtitle1",color:"textSecondary"},e))}))))}))),r.a.createElement(T.a,{mt:5},r.a.createElement(L,null))))},P=a(177),z=a(178),B=a(179),M=a(180),C=a(181),A=a(182),H=Object(W.a)((function(e){return{appBar:{borderBottom:"1px solid ".concat(e.palette.divider)},link:{margin:e.spacing(1,1.5)},toolbarTitle:{flexGrow:1},navDisplayFlex:{display:"flex",justifyContent:"space-between"},linkText:{textDecoration:"none",textTransform:"uppercase",color:"black"}}}));function J(e){var t=e.classes;return e.loggedIn?r.a.createElement(P.a,{href:"#",color:"primary",variant:"outlined",className:t.link,component:l.b,to:"/logout"},"Logout"):r.a.createElement(P.a,{href:"#",color:"primary",variant:"outlined",className:t.link,component:l.b,to:"/login"},"Login")}var Y=function(e){var t=H();return Object(n.useEffect)((function(){e.loggedIn||function(e){var t=sessionStorage.getItem("refresh_token");if(t){var a=JSON.parse(atob(t.split(".")[1])),n=Math.ceil(Date.now()/1e3);console.log(t),a.exp>n&&e(!0)}}(e.setLoggedIn)})),r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null),r.a.createElement(z.a,{position:"static",color:"default",elevation:0,className:t.appBar},r.a.createElement(B.a,{className:t.toolbar},r.a.createElement(N.a,{variant:"h6",color:"inherit",noWrap:!0,className:t.toolbarTitle},r.a.createElement(_.a,{component:l.b,to:"/",underline:"none",color:"textPrimary"},"Caller App")),r.a.createElement(M.a,{component:"nav","aria-labelledby":"main navigation",className:t.navDisplayFlex},e.loggedIn?[{title:"Notification History",path:"/notification-history",viewableByManager:"False"},{title:"Rotation History",path:"/rotation",viewableByManager:"True"},{title:"Start Rotation",path:"/start-rotation",viewableByManager:"True"},{title:"Profile",path:"/profile",viewableByManager:"False"}].map((function(a){var n=a.title,o=a.path,i=a.viewableByManager;return"all"===i||i===e.profile.is_manager?r.a.createElement(_.a,{component:l.b,to:o,underline:"none",key:n,className:t.linkText},r.a.createElement(C.a,{button:!0},r.a.createElement(A.a,{primary:n}))):null})):null),r.a.createElement(J,{classes:t,loggedIn:e.loggedIn}))))},q=a(193),V=a(184),U=a(192),Z=a(16),$=a(39),G=a(69),K=a.n(G),Q=a(91),X=a(92),ee="http://64.227.53.237/api/v1/",te=a.n(X).a.create({baseURL:ee,timeout:15e3,headers:{authorization:sessionStorage.getItem("access_token")?"JWT "+sessionStorage.getItem("access_token"):null,"Content-Type":"application/json",accept:"application/json"}});te.interceptors.response.use((function(e){return e}),function(){var e=Object(Q.a)(K.a.mark((function e(t){var a,n,r,o;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.config,"undefined"!==typeof t.response){e.next=4;break}return console.log("Unknown error"),e.abrupt("return",Promise.reject(t));case 4:if(401!==t.response.status||a.url!==ee+"user/token/refresh"){e.next=7;break}return window.location.href="/login/",e.abrupt("return",Promise.reject(t));case 7:if("token_not_valid"!==t.response.data.code||401!==t.response.status||"Unauthorized"!==t.response.statusText){e.next=23;break}if(!(n=sessionStorage.getItem("refresh_token"))){e.next=21;break}if(r=JSON.parse(atob(n.split(".")[1])),o=Math.ceil(Date.now()/1e3),console.log(n),!(r.exp>o)){e.next=17;break}return e.abrupt("return",te.post("user/token/refresh",{refresh:n}).then((function(e){return sessionStorage.setItem("access_token",e.data.access),sessionStorage.setItem("refresh_token",e.data.refresh),te.defaults.headers.authorization="JWT "+e.data.access,a.headers.authorization="JWT "+e.data.access,te(a)})).catch((function(e){console.log(e)})));case 17:console.log("Refresh token is expired",r.exp,o),window.location.href="/login";case 19:e.next=23;break;case 21:console.log("Refresh token not available."),window.location.href="/login";case 23:return e.abrupt("return",Promise.reject(t));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var ae=te,ne=Object(W.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function re(e){var t=ne(),a=Object(s.f)(),o=Object(n.useState)(""),i=Object(c.a)(o,2),l=i[0],m=i[1];return r.a.createElement(Z.c,{initialValues:{email:"",password:""},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<4&&(t.password="Password length must be greater than 4 characters"):t.password="Required",t},onSubmit:function(t,n){var r=n.setSubmitting;m(""),ae.post("user/login",{email:t.email,password:t.password}).then((function(t){sessionStorage.setItem("access_token",t.data.access),sessionStorage.setItem("refresh_token",t.data.refresh),ae.defaults.headers.authorization="JWT "+sessionStorage.getItem("access_token"),e.setLoggedIn(!0)})).then((function(){ae.get("user/profile").then((function(t){e.setProfile(t.data)}))})).then((function(){a.push("/")})).catch((function(e){m("The email and password do not match our records")})),setTimeout((function(){r(!1)}),800)}},(function(e){var a=e.submitForm,n=e.isSubmitting;return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement(u.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(q.a,{className:t.avatar}),r.a.createElement(N.a,{component:"h1",variant:"h5"},"Sign in"),l&&r.a.createElement(U.a,{severity:"error"},l),r.a.createElement(Z.b,{className:t.form},r.a.createElement(Z.a,{component:$.b,name:"email",type:"email",label:"Email Address",variant:"outlined",margin:"normal",fullWidth:!0,autoFocus:!0}),r.a.createElement("br",null),r.a.createElement(Z.a,{component:$.b,type:"password",label:"Password",name:"password",variant:"outlined",margin:"normal",required:!0,fullWidth:!0}),n&&r.a.createElement(V.a,null),r.a.createElement("br",null),r.a.createElement(P.a,{variant:"contained",fullWidth:!0,color:"primary",className:t.submit,disabled:n,onClick:a},"Submit"))))}))}function oe(e){var t=Object(s.f)();return Object(n.useEffect)((function(){e.setLoggedIn(!1),ae.post("user/logout/blacklist",{refresh_token:sessionStorage.getItem("refresh_token")}),sessionStorage.removeItem("access_token"),sessionStorage.removeItem("refresh_token"),ae.defaults.headers.authorization=null,t.push("/login")})),r.a.createElement("div",null,"Logout")}var ie=Object(W.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},input:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function ce(e){var t=ie(),a=(Object(s.f)(),Object(n.useState)("")),o=Object(c.a)(a,2),i=o[0],l=o[1];return r.a.createElement(Z.c,{initialValues:{phone_number:e.profile.phone_number,allow_notifications:e.profile.allow_notifications},validate:function(e){var t={};return e.phone_number?/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(e.phone_number)||(t.phone_number="Invalid Phone Number"):t.phone_number="xxx-xxx-xxxx",t},onSubmit:function(t,a){var n=a.setSubmitting;l(""),console.log(t),ae.put("/user/profile",{phone_number:t.phone_number,allow_notifications:t.allow_notifications}).then((function(){return e.setProfile(Object(p.a)({},e.profile,{phone_number:t.phone_number,allow_notifications:t.allow_notifications}))})).catch((function(e){l("Your preferences could not be changed")})),setTimeout((function(){n(!1)}),800)}},(function(e){var a=e.submitForm,n=e.isSubmitting;e.setFieldValue;return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement(u.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(N.a,{component:"h1",variant:"h5"},"Profile Preferences"),i&&r.a.createElement(U.a,{severity:"error"},i),r.a.createElement(Z.b,{className:t.form},r.a.createElement(Z.a,{component:$.b,name:"phone_number",type:"phone_number",label:"Phone Number",variant:"outlined",margin:"normal",fullWidth:!0,autoFocus:!0}),r.a.createElement("br",null),r.a.createElement(Z.a,{component:$.a,type:"checkbox",name:"allow_notifications",variant:"outlined",margin:"normal",required:!0,fullWidth:!0}),"Notify",n&&r.a.createElement(V.a,null),r.a.createElement("br",null),r.a.createElement(P.a,{variant:"contained",fullWidth:!0,color:"primary",className:t.submit,disabled:n,onClick:a},"Submit changes"))))}))}function le(e){return r.a.createElement("em",null,e.text)}var se=a(94);var me=function(e){return function(t){var a=t.isLoading,n=Object(se.a)(t,["isLoading"]);return a?r.a.createElement(V.a,null):r.a.createElement(e,n)}},ue=a(185),pe=a(141),fe=a(186),ge=a(187),de=a(188),he=a(189),be=a(190),Ee=Object(W.a)({table:{minWidth:650}});function ye(e){var t=e.conditional||function(){return!1},a=Ee(),n=e.rows,o=e.headers,i=Object.keys(n[0]);return r.a.createElement(ue.a,{component:pe.a},r.a.createElement(fe.a,{className:a.table,"aria-label":"simple table"},r.a.createElement(ge.a,null,r.a.createElement(de.a,null,o.map((function(e,t){return r.a.createElement(he.a,{align:"left",key:t},e)})))),r.a.createElement(be.a,null,n.map((function(a){return r.a.createElement(de.a,{key:a.id},i.map((function(n,o){return t(a[n])?r.a.createElement(e.effect,{text:a[n]}):r.a.createElement(he.a,{key:o,align:"left"},a[n])})))})))))}var ve=Object(W.a)({header:{textAlign:"center",padding:"1rem",marginBottom:"1rem"}});function xe(){var e=Object(n.useState)([]),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(!0),l=Object(c.a)(i,2),s=l[0],m=l[1],u=ve(),p=me(ye);return Object(n.useEffect)((function(){ae.get("notification/notification-history").then((function(e){var t=e.data.filter((function(e){return e.completed}));o(t),m(!1)}))}),[]),r.a.createElement(w.a,null,r.a.createElement(N.a,{variant:"h3",className:u.header},"Notification History"),r.a.createElement(p,{isLoading:s,rows:a,headers:["ID","Start Date","End Date","Your name","Manager","Notification Type","Message","Response"],effect:le,conditional:function(e){return console.log(e),"ACCEPT"===e}}))}var je=Object(W.a)({header:{textAlign:"center",padding:"1rem",marginBottom:"1rem"}});function we(){var e=Object(n.useState)([]),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(!0),l=Object(c.a)(i,2),s=l[0],m=l[1],u=je(),p=me(ye);return Object(n.useEffect)((function(){ae.get("notification/rotation-history").then((function(e){o(e.data),m(!1)}))}),[]),r.a.createElement(w.a,null,r.a.createElement(N.a,{variant:"h3",className:u.header},"Rotation History"),r.a.createElement(p,{isLoading:s,rows:a,headers:["ID","Date","Message","Manager","Number of calls"]}))}var Oe=Object(W.a)((function(e){return{header:{textAlign:"center",padding:"1rem",marginBottom:"1rem"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function ke(){var e=Object(n.useState)([]),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(!0),l=Object(c.a)(i,2),m=l[0],p=l[1],f=Oe(),g=Object(n.useState)(""),d=Object(c.a)(g,2),h=(d[0],d[1]),b=Object(s.f)(),E=me(ye);return Object(n.useEffect)((function(){ae.get("user/list").then((function(e){var t=e.data.map((function(e){return e.allow_notifications=e.allow_notifications?"Yes":"No",delete e.is_manager,e}));o(t),p(!1)}))}),[]),r.a.createElement(w.a,null,r.a.createElement(N.a,{variant:"h3",className:f.header},"Start Rotation"),r.a.createElement(E,{isLoading:m,rows:a,headers:["ID","First Name","Last Name","Email","Phone Number","Allow Notifications"]}),r.a.createElement(Z.c,{initialValues:{message:""},validate:function(e){var t={};return e.message?e.message.length<10&&(t.message="Message length must be greater than 10 characters"):t.message="Required",t},onSubmit:function(e,t){var a=t.setSubmitting;h(""),ae.post("notification/start-rotation",{message:"".concat(e.message,". Press 1 for yes and 2 for no")}).then((function(e){console.log(e.data),b.push("/rotation-detail/".concat(e.data))})).catch((function(e){h("The email and password do not match our records"),console.log(e)})),setTimeout((function(){a(!1)}),800)}},(function(e){var t=e.submitForm,a=e.isSubmitting;return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement(u.a,null),r.a.createElement("div",{className:f.paper},r.a.createElement(Z.b,{className:f.form},r.a.createElement(Z.a,{component:$.b,name:"message",type:"message",label:"Message",variant:"outlined",margin:"normal",multiline:!0,fullWidth:!0,autoFocus:!0}),r.a.createElement("br",null),a&&r.a.createElement(V.a,null),r.a.createElement("br",null),r.a.createElement(P.a,{variant:"contained",fullWidth:!0,color:"primary",className:f.submit,disabled:a,onClick:t},"Submit"))))})))}var Se=Object(W.a)({header:{textAlign:"center",padding:"1rem",marginBottom:"1rem"}});function Ne(e){var t=Object(s.g)().id;console.log(t);var a=Object(n.useState)([]),o=Object(c.a)(a,2),i=o[0],l=o[1],m=Object(n.useState)(!0),u=Object(c.a)(m,2),p=u[0],f=u[1],g=Se(),d=me(ye);return Object(n.useEffect)((function(){ae.get("notification/rotation/".concat(t)).then((function(e){var t=e.data.map((function(e){return e.completed=e.completed?"Yes":"No",delete e.is_manager,e}));l(t),f(!1)}))}),[]),r.a.createElement(w.a,null,r.a.createElement(N.a,{variant:"h3",className:g.header},"Rotation Detail"),r.a.createElement(d,{isLoading:p,rows:i,headers:["ID","Start Date","End Date","Employee name","Manager name","Notification Type","Message","Response","Completed"]}))}var _e=function(){var e=Object(n.useState)({allow_notifications:"",is_manager:"",phone_number:""}),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(!1),m=Object(c.a)(i,2),u=m[0],p=m[1];return r.a.createElement(l.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y,{profile:a,loggedIn:u,setLoggedIn:p}),r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:"/",component:function(){return r.a.createElement(S,{loggedIn:u})}}),r.a.createElement(s.a,{exact:!0,path:"/notification-history",component:xe}),r.a.createElement(s.a,{exact:!0,path:"/login",component:function(){return r.a.createElement(re,{setLoggedIn:p,setProfile:o})}}),r.a.createElement(s.a,{exact:!0,path:"/logout",component:function(){return r.a.createElement(oe,{setLoggedIn:p})}}),r.a.createElement(s.a,{exact:!0,path:"/profile",component:function(){return r.a.createElement(ce,{profile:a,setProfile:o})}}),r.a.createElement(s.a,{exact:!0,path:"/rotation",component:function(){return r.a.createElement(we,{loggedIn:u,profile:a})}}),r.a.createElement(s.a,{exact:!0,path:"/start-rotation",component:function(){return r.a.createElement(ke,null)}}),r.a.createElement(s.a,{exact:!0,path:"/rotation-detail/:id",component:function(){return r.a.createElement(Ne,null)}})),r.a.createElement(R,null)))};a(138),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(_e,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[109,1,2]]]);
//# sourceMappingURL=main.2ea1d79a.chunk.js.map